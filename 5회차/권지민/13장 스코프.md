# 📚 스코프

모든 식별자(변수/함수/클래스 이름 등)는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수  있는 유효 범위가 결정된다. 이를 스코프라 한다.

함수 매개변수는 함수 내부에서만 참조 가능하다.

```js
var var1 = 1;

if (true) {
  var var2 = 2;
}

function foo () {
  var var3 = 3;
}

console.log(var1); // 1
console.log(var2); // 2
console.log(var3); // ReferenceError : var3 is not defined
```

### 📌 식별자 결정
```js
var x = 'global';

function foo (){
  var x = 'local';

  console.log(x);
}

foo(); // 'local'
console.log(x); // 'global'
```

같은 `x`라는 변수명을 참조할 때 자바스크립트 엔진은 어떤 변수를 참조할 것인지 결정해야하는데, 이를 `식별자 결정`이라 한다.

위 예제에서 제일 상단에서 선언한 변수는 global(전역) 변수로 어디에서든 접근이 가능하다.

하지만 foo 함수 내부에 선언된 x 변수는 local(지역) 변수로 함수 내부에서만 사용이 가능하다.

즉, 이름은 동일하지만 별개의 변수라는 뜻이다.

(전역/지역 변수는 아래에서 다시 설명함)

### 📌 스코프가 존재하는 이유

**_스코프라는 개념이 없었다면, 같은 이름을 가진 변수는 충돌을 일으키므로 프로그램 내부에서 하나만 사용할 수 밖에 없다._**

컴퓨터에서 파일 이름이 절대 중복되지 않을 수 있을까?

우리가 중복된 파일 이름을 사용할 수 있는 이유는 '폴더'가 존재하기 때문이다. 여기서 '폴더'가 스코프의 개념과 비슷하다.

스코프라는 개념이 존재하지 않았다면, 한 프로젝트 안에서 반드시 중복되지 않는 변수명만 사용해야하는데, 그렇게 되면 이름 짓는 것이 상당히 어려울 것이다.

## 🎀 스코프의 종류

### 📌 전역과 지역 변수
|구분|설명|스코프|변수|
|------|---|---|---|
|전역|코드의 가장 바깥 영역|전역 스코프|전역 변수|
|지역|함수 몸체 내부|지역 스코프|지역 변수|


## 🎀 스코프 체인
<img width="241" alt="image" src="https://github.com/mingzzi96/js-deep-dive-study/assets/134386378/d859b7cd-a45b-4311-b844-bf65b3000744">

위 이미지 처럼 스코프가 계층적으로 연결되어 있는 것을 스코프 체인이라 한다.

변수를 참조할 때, 스코프 체인을 통해 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동하며 선언된 변수를 검색한다.

이를 통해 상위 스코프에서 선언한 변수를 하위 스코프에서도 사용 가능하다. (하위 스코프 변수를 상위에서 사용하는 것은 불가능 하다.)

## 🎀 함수 레벨 스코프

자바스크립트에서는 오직 `var` 만이 함수 코드 블럭안에 있는 것만을 지역 변수로 인정한다.

```js
var i = 10;

for(var i = 0; i < 5; i++){
  console.log(i); // 0 1 2 3 4
}

console.log(i); // 5
```

`var`는 함수 내부에서만 지역 변수로 인정되기 때문에

위 와같은 코드에서는 전역 변수로 인정되어 중복 선언된다. 그래서 의도한 값과 다른 결과가 나온 것이다.

## 🎀 렉시컬 스코프

```js
var x = 1;

function foo () {
var x = 10;
bar();
}

function bar (){
console.log(x);
}

foo(); // 1
bar(); // 1
```

자바스크립트는 렉시컬 스코프로 함수를 어디서 정의했는가에 따라 상위 스코프를 결정한다.

함수가 호출된 위치는 상위 스코프 결정에 어떠한 영향도 주지 않는다.

1. bar 함수는 전역 코드 실행 전에 평가되어 함수 객체를 생성한다.
2. 자신이 정의된 전역 스코프를 기억한다.
3. bar 함수가 호출된 곳이 어디인지와 관계없이 기억하고 있는 전역 스코프를 상위 스코프로 사용한다.
